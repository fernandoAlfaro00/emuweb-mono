<html>
<head>
<script src="libs/adapter.min.js" ></script>
<script src="webrtcstreamer.js" ></script>
</head>
<body> 
	<center>
		<video id="video" playsinline> </video>
		<button id="btn_game_reset">Reset</button>
	</center>


	<script>        
		var webRtcServer      = null;
		window.onload         = function() { 
			webRtcServer      = new WebRtcStreamer("video",location.protocol+"//"+location.hostname+":8000");
			webRtcServer.connect("videocap://0", "audiocap://0");
		}
		window.onbeforeunload = function() { webRtcServer.disconnect(); }
		const ws = new WebSocket('ws://localhost:8090');
		document.addEventListener('keydown', (e) => {
			ws.send(JSON.stringify({ event: 'keydown', key: e.key }));
			console.log(`Tecla presionada: ${e.key}`);
		});
	
		document.addEventListener('keyup', (e) => {
			ws.send(JSON.stringify({ event: 'keyup', key: e.key }));
			console.log(`Tecla liberada: ${e.key}`);
		});
	
		const boton = document.getElementById('btn_game_reset');
		boton.addEventListener("click", (e) => {
			ws.send(JSON.stringify({ event: 'keydown', key: e.key }));
			console.log(`Presionando boton reinicio`);
			ws.send(JSON.stringify({ event: 'keyup', key: e.key }));
		});
	
	</script>
</body>
</html>